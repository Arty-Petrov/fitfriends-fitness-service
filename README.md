# Fitfriends

Сайт-платформа спортивного клуба, построен на микросервисной архитектуре и базовых технологиях NestJS, брокере сообщений RabbitMq и ReactJS.

## Ресурсы проектa

1. HTTP запросы находятся в файле `fitfriends/apps/api-gateway/src/app/controllers/Fitfriends.postman_collection.json`
1. Пример файла с переменными окружения fitfriends/envs/.env-example
1. Документация доступна по адресу http://localhost:3333/spec после запуска сервиcа api-gateway
1. Список микросервисов:
    - api-gateway — содержит http контроллеры
    - users — отвечает за авторизацию, хранение сессий, пользователей и друзей
    - fitness — содержит бизнес логику приложения
    - storage — отвечает за обработку файлов
    - notify — управляет рассылками по подпискам и уведомлениями
1. Списки сценариев для микросервисов:
    - serve — запускает сервис, доступен для всех сервисов.
1. Сценарии для сервиса fitness

    - db-reset — делает перестановку клиента prisma
    - db-generate — генерирует клиента в соответствие со схемой
    - db-migrate — осуществляет миграцию БД

   Запуск сценариев осуществляется через `nx run <название сервиса>:<название сценария>`

1. Сценарии командной строки:

    - `services:docker-up` — загрузит и сконфигурирует контейнеры docker
    - `services:docker-start` — запустит все контейнеры
    - `services:docker-stop` — остановит все контейнеры
    - `services:db-init` — проинициализирует prisma
    - `services:db-seed` — заполнит базы данных тестовыми данными
    - `services:db-reset` — очистит базы данных
    - `services:start` — запустит все микросервисы
    - `services:lint` — выполнит проверку линтером

1. Команда генерации тестовых данных создает две учетные записи:
   `coach@fitfriends.local` — роль тренера

   `customer@fitfriends.local` — роль клиента

   Пароль для всех учетных записей: `123456`

## Порядок действий для запуска проекта

1. Создайте файл .env в папке fitfriends/envs/ обновите переменные окружения по образцу в файле .env-example
1. Установите зависимости `npm i`
1. Установите docker
1. В директории ./fitfriends запустите сценарии в следующем порядке:
    - `npm run servisec:docker-up`
    - `npm run services:docker-start`
    - `npm run services:start`

1. Перейдите в другое окно терминала
    - `npm run services:db-init`
    - `npm run services:seed`